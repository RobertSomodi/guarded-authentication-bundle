services:
      app.security.login_form_authenticator:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Guard\LoginFormAuthenticator
             autowire: true
             arguments:
                  $loginForm: '%jafar_guarded_authentication.login_form%'
                  $loginRoute: '%jafar_guarded_authentication.login_route%'
                  $homeRoute: '%jafar_guarded_authentication.home_page_route%'
      app.security.jwt_token_authenticator:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Guard\JwtAuthenticator
             autowire: true
             arguments:
                  $loginRoute: '%jafar_guarded_authentication.api_login_route%'
                  $homeRoute: '%jafar_guarded_authentication.api_home_page_route%'
      Jafar\Bundle\GuardedAuthenticationBundle\Api\ApiResponseFactory:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Api\ApiResponseFactory
             autowire: true
      Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Provider\JWSProviderInterface:
             alias: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Provider\JWSProvider

      Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Provider\JWSProvider:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Provider\JWSProvider
             public: false
             autowire: true
             arguments:
                  $ttl: '%jafar_guarded_authentication.token_ttl%'

      Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\KeyLoader\AbstractKeyLoader:
             abstract: true
             public: false
             arguments: ['%jafar_guarded_authentication.pass_phrase%', '%kernel.project_dir%/var/jwt_keys/']

      Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\KeyLoader\KeyLoaderInterface:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\KeyLoader\OpenSSLKeyLoader
             parent: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\KeyLoader\AbstractKeyLoader

      Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Encoder\JWTEncoderInterface:
             class: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Encoder\JWTEncoder
             public: true
             autowire: true
             arguments: ['@Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Provider\JWSProviderInterface']

      jafar_guarded_authentication.encoder:
             public: true
             alias: Jafar\Bundle\GuardedAuthenticationBundle\Api\JWT\Encoder\JWTEncoderInterface

      jafar.command.key_generator:
             public: false
             class: Jafar\Bundle\GuardedAuthenticationBundle\Command\KeysGeneratorCommand
             arguments: ['%kernel.project_dir%/var/jwt_keys/']
             tags:
                 - { name: console.command, command: jafar:generate-keys }


